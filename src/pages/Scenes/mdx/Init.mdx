import SceneModule from '@/components/SceneModule';

import AddListener from '../modules/init/AddListener';
import AddListenerCss from '../modules/init/AddListener/index.module.less?raw';
import AddListenerTypeScript from '../modules/init/AddListener/index.tsx?raw';
import BasicUse from '../modules/init/BasicUse';
import BasicUseCss from '../modules/init/BasicUse/index.module.less?raw';
import BasicUseTypeScript from '../modules/init/BasicUse/index.tsx?raw';
import ESMUse from '../modules/init/ESMUse';
import ESMUseCss from '../modules/init/ESMUse/index.module.less?raw';
import ESMUseTypeScript from '../modules/init/ESMUse/index.tsx?raw';

# 初始化

初始化 SDK 后，才能使用 SDK 提供的功能。

## 如何使用

- 请确保已根据 [接入流程](https://doc.yunxin.163.com/messaging2/guide/TEzOTczMDI?platform=client) 创建应用并获取 App Key
- 详情请参考 [初始化 Web/uni-app/小程序 SDK](https://doc.yunxin.163.com/messaging2/guide/zY4OTcyODQ?platform=client)

## 场景演示

<SceneModule
  title="基础用法"
  description="展示如何初始化 NIM SDK"
  tsCode={BasicUseTypeScript}
  cssCode={BasicUseCss}
>
  <BasicUse />
</SceneModule>

<SceneModule
  title="ESM引入"
  description={
    <p>
      通过 ESM 引入 SDK 并进行初始化，完整功能请查看{' '}
      <a href="https://doc.yunxin.163.com/messaging2/guide/DcyMjA1Njk?platform=client#方式二esm-引入">
        集成文档
      </a>
    </p>
  }
  tsCode={ESMUseTypeScript}
  cssCode={ESMUseCss}
>
  <ESMUse />
</SceneModule>

<SceneModule
  title="事件监听"
  description={<p>初始化完成后，您可以监听事件，获取各个服务的状态变更。</p>}
  tsCode={AddListenerTypeScript}
  cssCode={AddListenerCss}
>
  <AddListener />
</SceneModule>

## 初始化参数

### NIMInitializeOptions

NIMInitializeOptions 详情请参考：[API 文档](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_NIMInterface.NIMInitializeOptions.html)

| 属性名                    | 类型      | 默认值 | 说明                     |
| ------------------------- | --------- | ------ | ------------------------ |
| appkey                    | string    |        | 应用的 AppKey（必填）    |
| account                   | string?   |        | 用户账号                 |
| token                     | string?   |        | 登录凭证                 |
| apiVersion                | string?   |        | API 版本                 |
| authType                  | number?   |        | 认证类型                 |
| binaryWebsocket           | boolean?  |        | 是否使用二进制 WebSocket |
| customClientType          | number?   |        | 自定义客户端类型         |
| debugLevel                | string?   |        | 调试级别                 |
| enableV2CloudConversation | boolean?  |        | 是否启用 V2 云端会话     |
| flutterSdkVersion         | string?   |        | Flutter SDK 版本         |
| isAbtestEnable            | boolean?  |        | 是否启用 A/B 测试        |
| isFixedDeviceId           | boolean?  |        | 是否固定设备 ID          |
| lbsUrls                   | string[]? |        | 负载均衡服务器 URL 列表  |
| linkUrl                   | string?   |        | 链接 URL                 |
| loginSDKTypeParamCompat   | boolean?  |        | 登录 SDK 类型参数兼容性  |
| needReconnect             | boolean?  |        | 是否需要重连             |
| reconnectionAttempts      | number?   |        | 重连尝试次数             |
| socketConnectTimeout      | number?   |        | Socket 连接超时时间      |
| xhrConnectTimeout         | number?   |        | XHR 连接超时时间         |
| abtestUrl                 | string?   |        | A/B 测试 URL             |

### NIMOtherOptions

NIMOtherOptions 详情请参考：[API 文档](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_NIMInterface.NIMOtherOptions.html)

| 属性名                                                                                                                                                                                     | 类型                           | 默认值 | 说明                        |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------ | ------ | --------------------------- |
| [**V1NIMLoginServiceConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_V1NIMLoginService.NIMEModuleParamV1Login.html)                  | object?                        |        | V1 NIM 登录服务配置         |
| [**V2NIMClientAntispamUtilConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_NIMInterface.html#NIMEModuleParamV2NIMClientAntispamUtil)    | object?                        |        | V2 NIM 客户端反垃圾工具配置 |
| [**V2NIMLoginServiceConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_V2NIMLoginService.html#NIMEModuleParamV2Login)                     | object?                        |        | V2 NIM 登录服务配置         |
| [**V2NIMSyncServiceConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_SyncServiceInterface.SyncOptions.html)                           | object?                        |        | V2 NIM 同步服务配置         |
| [**abtestConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_NIMInterface.html#NIMOtherOptionsAbtestConfig)                                | object?                        |        | A/B 测试配置                |
| [**cloudStorageConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_CloudStorageServiceInterface.NIMEModuleParamCloudStorageConfig.html) | object?                        |        | 云存储配置                  |
| [**loggerConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_NIMInterface.html#NIMOtherOptionsLoggerConfig)                                | object?                        |        | 日志记录器配置              |
| [**privateConf**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_NIMInterface.html#NIMOtherOptionsPrivateConfig)                                | object?                        |        | 私有配置                    |
| qchatChannelConfig                                                                                                                                                                         | \{ autoSubscribe?: boolean \}? |        | 圈组频道配置                |
| qchatMediaConfig                                                                                                                                                                           | \{ neroom?: any \}?            |        | 圈组媒体配置                |
| [**reporterConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/modules/src_NIMInterface.html#NIMOtherOptionsReporterConfig)                            | object?                        |        | 报告器配置                  |
| [**syncConfig**](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/interfaces/src_SyncServiceInterface.SyncOptions.html)                                       | object?                        |        | 同步配置                    |

## 服务事件

监听事件分布在不同服务中，请参考对应服务的事件监听。

| 服务模块                      | 事件详情                                                                                                                                                                          |
| ----------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| V2NIMNotificationService      | [通知服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMNotificationService.V2NIMNotificationService.html#on)               |
| V2NIMSubscriptionService      | [订阅服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMSubscriptionService.V2NIMSubscriptionService.html#on)               |
| V2NIMConversationGroupService | [会话组服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMConversationGroupService.V2NIMConversationGroupService.html#on)   |
| V2NIMLocalConversationService | [本地会话服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMLocalConversationService.V2NIMLocalConversationService.html#on) |
| V2NIMConversationService      | [会话服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMConversationService.V2NIMConversationService.html#on)               |
| SignalingServiceInterface     | [信令服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_SignalingServiceInterface.SignalingServiceInterface.html#on)             |
| V2NIMAIService                | [AI服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMAIService.V2NIMAIService.html#on)                                     |
| V2NIMFriendService            | [好友服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMFriendService.V2NIMFriendService.html#on)                           |
| V2NIMLoginService             | [登录服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMLoginService.V2NIMLoginService.html#on)                             |
| V2NIMMessageService           | [消息服务事件](https://doc.yunxin.163.com/messaging2/references/web/typedoc/Latest/zh/v2/nim/classes/src_V2NIMMessageService.V2NIMMessageService.html#on)                         |
